knitr::opts_chunk$set(echo = TRUE)
fit1   = readRDS("fit1.rds")
fit1.1 = readRDS("fit1_1.rds")
fit1.2 = readRDS("fit1_2.rds")
fit1.3 = readRDS("fit1_3.rds")
fit1.4 = readRDS("fit1_4.rds")
# Instalação do pacote (rodar só 1x)
#install.packages("devtools")
#library(devtools)
library(FlexCoDE)
library(ggplot2)
teste=read.csv("teste.csv", encoding = "utf8")
pred1=predict(fit1,xtest1,B=fit1$n_grid,predictionBandProb=FALSE)
xtest1=teste[c(colors_broad,colors_galex, colors_wise)]
colors_tudo = names(teste)[seq(21,35)]
colors_broad = c("u_PStotal.r_PStotal","g_PStotal.r_PStotal",
"r_PStotal.i_PStotal","r_PStotal.z_PStotal")
colors_wise = c("r_PStotal.W1_MAG","r_PStotal.W2_MAG")
colors_galex = c("FUVmag.r_PStotal","NUVmag.r_PStotal")
pred1=predict(fit1,xtest1,B=fit1$n_grid,predictionBandProb=FALSE)
xtest1=teste[c(colors_broad,colors_galex, colors_wise)]
xtest2=teste[colors_tudo]
ztest=teste['Z']
pred1=predict(fit1,xtest1,B=fit1$n_grid,predictionBandProb=FALSE)
pred1.1=predict(fit1.1,xtest1,B=fit1.1$n_grid,predictionBandProb=FALSE)
pred1.2=predict(fit1.2,xtest1,B=fit1.1$n_grid,predictionBandProb=FALSE)
pred1.3=predict(fit1.3,xtest1,B=fit1.1$n_grid,predictionBandProb=FALSE)
pred1.4=predict(fit1.4,xtest1,B=fit1.1$n_grid,predictionBandProb=FALSE)
pred_mean_broad = list(z=(pred1$z+pred1.1$z+pred1.2$z+pred1.3$z+pred1.4$z)/5,CDE=(pred1$CDE+pred1.1$CDE+pred1.2$CDE+pred1.3$CDE+pred1.4$CDE)/5)
rm(fit1)
rm(fit1.1)
rm(fit1.2)
rm(fit1.3)
rm(fit1.4)
rm(pred1)
rm(pred1.1)
rm(pred1.2)
rm(pred1.3)
rm(pred1.4)
fit2   = readRDS("fit2.rds")
fit2.1 = readRDS("fit2_1.rds")
fit2.2 = readRDS("fit2_2.rds")
fit2.3 = readRDS("fit2_3.rds")
fit2.4 = readRDS("fit2_4.rds")
pred2=predict(fit2,xtest2,B=fit2$n_grid,predictionBandProb=FALSE)
pred2.1=predict(fit2.1,xtest2,B=fit2.1$n_grid,predictionBandProb=FALSE)
pred2.2=predict(fit2.2,xtest2,B=fit2.1$n_grid,predictionBandProb=FALSE)
pred2.3=predict(fit2.3,xtest2,B=fit2.1$n_grid,predictionBandProb=FALSE)
pred2.4=predict(fit2.4,xtest2,B=fit2.1$n_grid,predictionBandProb=FALSE)
pred_mean_narrow = list(z=(pred2$z+pred2.1$z+pred2.2$z+pred2.3$z+pred2.4$z)/5,CDE=(pred2$CDE+pred2.1$CDE+pred2.2$CDE+pred2.3$CDE+pred2.4$CDE)/5)
meanz_1.1 = pred_mean_broad$CDE %*% pred_mean_broad$z / rowSums(pred_mean_broad$CDE)
meanz2.2 = pred_mean_narrow$CDE %*% pred_mean_narrow$z / rowSums(pred_mean_narrow$CDE)
write.csv(meanz_1.1, "est_pontuais_broad.csv")
write.csv(meanz2.2, "est_pontuais_narrow.csv")
getwd()
df_broad = data.frame('RA'=teste$RA_1, 'DEC'=teste$DEC_1, 'z_pred'=meanz_1.1)
df_narrow = data.frame('RA'=teste$RA_1, 'DEC'=teste$DEC_1, 'z_pred'=meanz2.2)
write.csv(df_broad , "est_pontuais_broad.csv")
write.csv(df_narrow , "est_pontuais_narrow.csv")
df_broad
